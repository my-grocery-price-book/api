- name: ensure github.com is a known host
  sudo: no
  known_hosts:
    key: "{{ lookup('pipe', 'ssh-keyscan -t rsa github.com') }}"
    host: "github.com"

- name: installing sqlite gem dependencies for mutant specs
  apt: name={{item}} state=present
  sudo: yes
  with_items:
    - sqlite3
    - libsqlite3-dev

- name: bundle install
  sudo: no
  command: bundle install --clean --jobs 2 --path vendor/bundle
  args:
    chdir: /vagrant
    creates: /vagrant/vendor/bundle

- name: installing aws eb dependencies
  apt: name={{item}} state=present
  sudo: yes
  with_items:
    - python

- name: download get-pip.py
  get_url: url=https://bootstrap.pypa.io/get-pip.py dest=~/get-pip.py
  sudo: yes

- name: install pip
  command: python ~/get-pip.py
  sudo: yes

- name: install awsebcli
  pip: name=awsebcli state=latest
  sudo: yes
